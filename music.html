<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-097VQD41F8"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-097VQD41F8');
    </script>
    <title>Music Maker - Scott Friedman</title>

    <!-- SEO Meta Tags -->
    <meta name="description" content="Browser-based step sequencer - create beats with drums and melodies">

    <!-- Open Graph -->
    <meta property="og:title" content="Music Maker - Scott Friedman">
    <meta property="og:description" content="Browser-based step sequencer - create beats with drums and melodies">
    <meta property="og:image" content="https://scottfriedman.me/assets/og-image.png">
    <meta property="og:url" content="https://scottfriedman.me/music.html">
    <meta property="og:type" content="website">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Music Maker - Scott Friedman">
    <meta name="twitter:description" content="Browser-based step sequencer - create beats with drums and melodies">
    <meta name="twitter:image" content="https://scottfriedman.me/assets/og-image.png">

    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/music.css">
</head>
<body>
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <!-- Collaborative drawing canvas -->
    <canvas id="whiteboard"></canvas>

    <!-- Mobile draw mode toggle -->
    <button class="mobile-draw-toggle" aria-label="Toggle draw mode">
        <span class="toggle-icon">✎</span>
    </button>

    <main id="main-content">
        <header>
            <a href="index.html" class="back-link">back to home</a>
            <h1>Music Maker</h1>
            <p class="tagline">Create beats, share with everyone</p>
        </header>

        <hr>

        <!-- Bar Creator Section -->
        <section id="creator" class="creator-section">
            <div class="creator-header">
                <div class="mode-toggle">
                    <button class="mode-btn active" data-mode="simple">Simple</button>
                    <button class="mode-btn" data-mode="advanced">Advanced</button>
                </div>
                <div class="tempo-control">
                    <label>BPM:</label>
                    <select id="tempo-select" class="tempo-simple">
                        <option value="80">Slow (80)</option>
                        <option value="100" selected>Medium (100)</option>
                        <option value="120">Fast (120)</option>
                    </select>
                    <input type="range" id="tempo-slider" class="tempo-advanced" min="60" max="180" value="100" style="display:none;">
                    <span id="tempo-value" class="tempo-advanced" style="display:none;">100</span>
                </div>
                <div class="creator-controls">
                    <button id="randomize-btn" class="control-btn randomize">Randomize</button>
                    <button id="play-btn" class="control-btn play">▶ Play</button>
                    <button id="stop-btn" class="control-btn stop">◼ Stop</button>
                    <button id="clear-btn" class="control-btn clear">Clear</button>
                    <button id="save-bar-btn" class="control-btn save">Save Bar</button>
                </div>
            </div>

            <!-- Step Sequencer Grid -->
            <div class="sequencer">
                <!-- Drums Section -->
                <div class="track-section">
                    <div class="section-label">DRUMS</div>
                    <div class="tracks" id="drum-tracks">
                        <!-- Rows generated by JS -->
                    </div>
                </div>

                <!-- Melody Section -->
                <div class="track-section">
                    <div class="section-label">MELODY</div>
                    <div class="chord-helpers">
                        <span class="helper-label">Quick chords:</span>
                        <button class="chord-btn" data-chord="C">C</button>
                        <button class="chord-btn" data-chord="Am">Am</button>
                        <button class="chord-btn" data-chord="G">G</button>
                        <button class="chord-btn" data-chord="Dm">Dm</button>
                        <button class="chord-btn" data-chord="Em">Em</button>
                    </div>
                    <div class="tracks" id="melody-tracks">
                        <!-- Rows generated by JS -->
                    </div>
                </div>
            </div>

            <!-- Playhead indicator -->
            <div id="playhead" class="playhead" style="display:none;"></div>
        </section>

        <hr>

        <!-- Bar Library Section -->
        <section id="library">
            <h2>Bar Library</h2>
            <p class="section-hint">Click a bar to add it to your song</p>
            <div id="bar-library" class="bar-library">
                <p class="loading">Loading bars...</p>
            </div>
        </section>

        <hr>

        <!-- Song Arranger Section -->
        <section id="arranger">
            <h2>Song Arranger</h2>
            <div class="arranger-controls">
                <button id="play-song-btn" class="control-btn play">▶ Play Song</button>
                <button id="stop-song-btn" class="control-btn stop">◼ Stop</button>
                <button id="clear-song-btn" class="control-btn clear">Clear</button>
                <button id="save-song-btn" class="control-btn save">Save Song</button>
            </div>
            <div id="song-timeline" class="song-timeline">
                <p class="timeline-hint">Add bars from the library above</p>
            </div>
        </section>

        <hr>

        <!-- Saved Songs Section -->
        <section id="songs">
            <h2>Saved Songs</h2>
            <div id="song-list" class="song-list">
                <p class="loading">Loading songs...</p>
            </div>
        </section>

        <hr>

        <footer>
            <p class="small">Built with Tone.js</p>
        </footer>
    </main>

    <!-- Save Modal -->
    <div id="save-modal" class="modal">
        <div class="modal-content">
            <h3 id="modal-title">Save Bar</h3>
            <label for="save-name">Name your creation:</label>
            <input type="text" id="save-name" placeholder="Funky Beat" maxlength="30">
            <label for="creator-name">Your name:</label>
            <input type="text" id="creator-name" placeholder="Anonymous" maxlength="20">
            <div class="modal-actions">
                <button id="modal-cancel" class="control-btn">Cancel</button>
                <button id="modal-save" class="control-btn save">Save</button>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <!-- Tone.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>

    <!-- Main site JS (for drawing) -->
    <script src="js/firebase-config.js"></script>
    <script src="js/main.js"></script>

    <!-- Music Maker JS -->
    <script src="js/music.js"></script>
</body>
</html>
